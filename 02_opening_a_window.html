<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Opening A Window - learn-gfx-hal</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="01_introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><a href="02_opening_a_window.html" class="active"><strong aria-hidden="true">2.</strong> Opening A Window</a></li><li><a href="03_clear_the_window.html"><strong aria-hidden="true">3.</strong> Clear The Window</a></li><li><a href="04_triangle_intro.html"><strong aria-hidden="true">4.</strong> Triangle Intro</a></li><li><a href="05_shaders.html"><strong aria-hidden="true">5.</strong> Shaders</a></li><li><a href="06_textures.html"><strong aria-hidden="true">6.</strong> Textures</a></li><li><a href="07_coordinates.html"><strong aria-hidden="true">7.</strong> Coordinates</a></li><li><a href="08_camera.html"><strong aria-hidden="true">8.</strong> Camera</a></li><li><a href="09_depth_buffer.html"><strong aria-hidden="true">9.</strong> Depth Buffer</a></li><li><a href="10_instanced_drawing.html"><strong aria-hidden="true">10.</strong> Instanced Drawing</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">learn-gfx-hal</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#opening-a-window" id="opening-a-window"><h1>Opening A Window</h1></a>
<p>Before we can draw anything, we need a place to draw it. That means we need to
open a window.</p>
<a class="header" href="#initializing-a-window" id="initializing-a-window"><h2>Initializing A Window</h2></a>
<p>To open a window in Rust, you want to use the <a href="https://docs.rs/winit/">winit</a>
crate to get the best cross-platform coverage available. At the time of writing,
the latest version is 0.18. Set up a project for this tutorial however you like
and just add <code>winit</code> to your <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[dependencies]
winit = &quot;0.18&quot;
</code></pre>
<p>The <code>winit</code> crate is what you'd call &quot;mostly stable&quot;. There are small breaking changes
with new versions, but it's usually plain enough to see what the new types or methods
that you need to move to are.</p>
<p>The <a href="https://docs.rs/winit/0.18.0/winit/#building-a-window">crate documentation</a>
goes over the basic steps of building a window:</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let events_loop = EventsLoop::new();
let window = WindowBuilder::new()
  .with_title(&quot;Example&quot;)
  .build(&amp;events_loop)
  .expect(&quot;Could not create a window!&quot;);
#}</code></pre></pre>
<p>Of course, the
<a href="https://docs.rs/winit/0.18.0/winit/struct.WindowBuilder.html">WindowBuilder</a>
type has many other methods you might want to use, so be sure to check all
that out.</p>
<a class="header" href="#responding-to-events" id="responding-to-events"><h2>Responding To Events</h2></a>
<p>Once the window is open the user will try to interact with the window. They'll
move the mouse, type keys, click the <code>x</code> in the corner to close it, things like
that. You handle all of this with
<a href="https://docs.rs/winit/0.18.0/winit/struct.EventsLoop.html">EventsLoop</a>.
You can call
<a href="https://docs.rs/winit/0.18.0/winit/struct.EventsLoop.html#method.run_forever">run_forever</a>
with a callback, or
<a href="https://docs.rs/winit/0.18.0/winit/struct.EventsLoop.html#method.poll_events">poll_events</a>
with a callback. In both cases, your callback gets an
<a href="https://docs.rs/winit/0.18.0/winit/enum.Event.html">Event</a>, which is an enum.
Naturally we have to match on that and find the cases we care about. We can discard the
other types. You'll actually get a whole lot of events through <code>winit</code>,
so it's definitely good to ignore most of them if you only care about one or two
event types.</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
let mut running = true;
while running {
  events_loop.poll_events(|event| match event {
    Event::WindowEvent {
      event: WindowEvent::CloseRequested,
      ..
    } =&gt; running = false,
    _ =&gt; (),
  });
}
#}</code></pre></pre>
<a class="header" href="#pack-it-together" id="pack-it-together"><h2>Pack It Together</h2></a>
<p>We'll have a lot of things floating around as we go along, so we'll want to pack
things together when we can. Winit doesn't care what graphical libs you're using
to draw within the frame, so we can keep just the windowing stuff in its own
struct, apart from any gfx-hal things.</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
#[derive(Debug)]
pub struct WinitState {
  pub events_loop: EventsLoop,
  pub window: Window,
}
#}</code></pre></pre>
<p>Of course, we want to streamline those building steps:</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
impl WinitState {
  /// Constructs a new `EventsLoop` and `Window` pair.
  ///
  /// The specified title and size are used, other elements are default.
  /// ## Failure
  /// It's possible for the window creation to fail. This is unlikely.
  pub fn new&lt;T: Into&lt;String&gt;&gt;(title: T, size: LogicalSize) -&gt; Result&lt;Self, CreationError&gt; {
    let events_loop = EventsLoop::new();
    let output = WindowBuilder::new()
      .with_title(title)
      .with_dimensions(size)
      .build(&amp;events_loop);
    output.map(|window| Self {
      events_loop,
      window,
    })
  }
}
#}</code></pre></pre>
<p>And we probably want to go one step farther for our examples and just give a
<code>Default</code> impl that calls <code>new</code> with some default values and then panics if
there's a <code>CreationError</code>.</p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
pub const WINDOW_NAME: &amp;str = &quot;Hello Winit&quot;;

impl Default for WinitState {
  /// Makes an 800x600 window with the `WINDOW_NAME` value as the title.
  /// ## Panics
  /// If a `CreationError` occurs.
  fn default() -&gt; Self {
    Self::new(
      WINDOW_NAME,
      LogicalSize {
        width: 800.0,
        height: 600.0,
      },
    )
    .expect(&quot;Could not create a window!&quot;)
  }
}
#}</code></pre></pre>
<a class="header" href="#running-the-program" id="running-the-program"><h2>Running The Program</h2></a>
<p>So far we only have a very tiny main function to look at:</p>
<pre><pre class="playpen"><code class="language-rust">fn main() {
  let mut winit_state = WinitState::default();
  let mut running = true;
  while running {
    winit_state.events_loop.poll_events(|event| match event {
      Event::WindowEvent {
        event: WindowEvent::CloseRequested,
        ..
      } =&gt; running = false,
      _ =&gt; (),
    });
  }
}
</code></pre></pre>
<p>If you run this you get an all white window. Actually, without anything being
drawn to the window, it might instead show all black, or even just garbage pixel
data. It depends on your windowing system.</p>
<p>Also, normally an application would use &quot;Vertical Synchronization&quot; (Vsync) to
slow down the main loop. Without any drawing code we can't use vsync, so the
loop will run as fast as possible and use 100% of the core it's on.</p>
<p>Both things are not good, but this is just a stepping stone and we learn
to draw stuff in the next lesson, so it's fine.</p>
<p><img src="images/hello-winit-complete.png" alt="hello-winit-complete" /></p>
<p>All of the code discussed here is available within the
<a href="https://github.com/gfx-rs/learn-gfx-hal/blob/master/examples/hello_winit.rs">hello_winit</a>
example.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="01_introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="03_clear_the_window.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="01_introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="03_clear_the_window.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
